<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>接口测试</title>
  <link rel="stylesheet" href="__STATIC__/plugins/layui/css/layui.css" media="all" />
  <link rel="stylesheet" href="__ADMIN__/css/global.css" media="all">
  <link rel="stylesheet" href="__STATIC__/common/css/font.css" media="all">
  <!-- <script type="text/javascript" src="__HOME__/js/jquery.min.js"></script> -->
  <script type="text/javascript" src="__STATIC__/plugins/layui/layui.js"></script>
  <script src="__STATIC__/common/js/jquery.2.1.1.min.js"></script>
</head>

<body>
  <div class="admin-main layui-anim layui-anim-upbit">
    <fieldset class="layui-elem-field layui-field-title">
      <legend>接口测试</legend>
    </fieldset>
    <form class="layui-form layui-form-pane" action="index.html" method="post">
      <div class="layui-form-item">
        <label class="layui-form-label">物流起始点</label>
        <div class="layui-input-4" id="box_qsd">
          <div class="layui-input-inline"><select name="qsd[]" id="qsd_province" lay-filter="qsd_province"><option value="">请选择省</option><option value="2">北京</option><option value="3">安徽</option><option value="4">福建</option><option value="5">甘肃</option><option value="6">广东</option><option value="7">广西</option><option value="8">贵州</option><option value="9">海南</option><option value="10">河北</option><option value="11">河南</option><option value="12">黑龙江</option><option value="13">湖北</option><option value="14">湖南</option><option value="15">吉林</option><option value="16">江苏</option><option value="17">江西</option><option value="18">辽宁</option><option value="19">内蒙古</option><option value="20">宁夏</option><option value="21">青海</option><option value="22">山东</option><option value="23">山西</option><option value="24">陕西</option><option value="25">上海</option><option value="26">四川</option><option value="27">天津</option><option value="28">西藏</option><option value="29">新疆</option><option value="30">云南</option><option value="31">浙江</option><option value="32">重庆</option><option value="33">香港</option><option value="34">澳门</option><option value="35">台湾</option></select></div>
          <div class="layui-input-inline"><select name="qsd[]" id="qsd_city" lay-filter="qsd_city"><option value="">请选择市</option></select></div>
          <div class="layui-input-inline"><select name="qsd[]" id="qsd_district" lay-filter="qsd_district"><option value="">请选择县/区</option></select></div>
          <script>
            layui.use(['form'], function() {
              var form = layui.form;
              form.on('select(qsd_province)', function(data) {
                var pid = data.value;
                var loading = layer.load(1, {
                  shade: [0.1, '#fff']
                });
                $.get("__PUBLIC__/../index/getRegion.html?pid=" + pid, function(data) {

                  layer.close(loading);
                  var html = '<option value="">请选择市</option>';
                  $.each(data, function(i, value) {
                    html += '<option value="' + value.id + '">' + value.name + '</option>';
                  });
                  $('#qsd_city').html(html);
                  $('#qsd_district').html('<option value="">请选择县/区</option>');
                  form.render()
                },'json');
              });
              form.on('select(qsd_city)', function(data) {
                var pid = data.value;
                var loading = layer.load(1, {
                  shade: [0.1, '#fff']
                });
                $.get("__PUBLIC__/../index/getRegion.html?pid=" + pid, function(data) {
                  layer.close(loading);
                  var html = '<option value="">请选择县/区</option>';
                  $.each(data, function(i, value) {
                    html += '<option value="' + value.id + '">' + value.name + '</option>';
                  });
                  $('#qsd_district').html(html);

                  form.render()
                },'json');
              });
            });
          </script>
        </div>
      </div>
      <div class="layui-form-item">
        <label class="layui-form-label">物流终止点</label>
        <div class="layui-input-4" id="box_zzd">
          <div class="layui-input-inline"><select name="zzd[]" id="zzd_province" lay-filter="zzd_province"><option value="">请选择省</option><option value="2">北京</option><option value="3">安徽</option><option value="4">福建</option><option value="5">甘肃</option><option value="6">广东</option><option value="7">广西</option><option value="8">贵州</option><option value="9">海南</option><option value="10">河北</option><option value="11">河南</option><option value="12">黑龙江</option><option value="13">湖北</option><option value="14">湖南</option><option value="15">吉林</option><option value="16">江苏</option><option value="17">江西</option><option value="18">辽宁</option><option value="19">内蒙古</option><option value="20">宁夏</option><option value="21">青海</option><option value="22">山东</option><option value="23">山西</option><option value="24">陕西</option><option value="25">上海</option><option value="26">四川</option><option value="27">天津</option><option value="28">西藏</option><option value="29">新疆</option><option value="30">云南</option><option value="31">浙江</option><option value="32">重庆</option><option value="33">香港</option><option value="34">澳门</option><option value="35">台湾</option></select></div>
          <div class="layui-input-inline"><select name="zzd[]" id="zzd_city" lay-filter="zzd_city"><option value="">请选择市</option></select></div>
          <div class="layui-input-inline"><select name="zzd[]" id="zzd_district" lay-filter="zzd_district"><option value="">请选择县/区</option></select></div>
          <script>
            layui.use(['form'], function() {
              var form = layui.form;
              form.on('select(zzd_province)', function(data) {
                var pid = data.value;
                var loading = layer.load(1, {
                  shade: [0.1, '#fff']
                });
                $.get("__PUBLIC__/../index/getRegion.html?pid=" + pid, function(data) {
                  layer.close(loading);
                  var html = '<option value="">请选择市</option>';
                  $.each(data, function(i, value) {
                    html += '<option value="' + value.id + '">' + value.name + '</option>';
                  });
                  $('#zzd_city').html(html);
                  $('#zzd_district').html('<option value="">请选择县/区</option>');
                  form.render()
                },'json');
              });
              form.on('select(zzd_city)', function(data) {
                var pid = data.value;
                var loading = layer.load(1, {
                  shade: [0.1, '#fff']
                });
                $.get("__PUBLIC__/../index/getRegion.html?pid=" + pid, function(data) {
                  layer.close(loading);
                  var html = '<option value="">请选择县/区</option>';
                  $.each(data, function(i, value) {
                    html += '<option value="' + value.id + '">' + value.name + '</option>';
                  });
                  $('#zzd_district').html(html);
                  form.render()
                },'json');
              });
            });
          </script>
        </div>
      </div>
      <div class="layui-form-item">
        <button type="button" class="layui-btn" lay-submit="" lay-filter="submit">提交</button>
      </div>
    </form>
    <fieldset class="layui-elem-field layui-field-title">
      <legend>查询结果</legend>
    </fieldset>
    <div id="result" ></div>
  </div>
  <style media="screen">
    #result{ padding: 8px 15px; line-height: 20px; border-width: 1px; border-style: solid; border-radius: 2px 0 0 2px; background-color: #FBFBFB; overflow: hidden;  box-sizing: border-box; border-color: #e6e6e6;
    }
    #result ul li{ margin-bottom: 10px;}
    #result ul li span{ display: inline-block; margin-right: 10px;}
  </style>
  <script id="demo" type="text/html">
  <%#  if(d.zdlist){ %>
  <h3>可选择直达物流：</h3>
  <br>
  <ul>
    <%#  layui.each(d.zdlist, function(index, item){ %>
    <li>
      <span><% index+1 %>.<% item.wltitle %></span>
      <span>地址：<% item.wladdress %></span>
      <span>电话：<% item.wltel %></span>
    </li>
    <%#  }); %>
  </ul>
  <%#  } %>
  <br>
  <%#  layui.each(d.zhongzhuan, function(index, item){ %>
  <%#  if(d.zdlist){ %>
  <h3>可选择在<% item.title %>中转：</h3>
  <%#  }else{ %>
  <h3>需在<% item.title %>中转：</h3>
  <%#  } %>
  <br>
  <%#  if(item.info){ %>
  <ul>
    <li>
      <span>服务费(每公斤)&nbsp;:&nbsp;<% item.info.zzfwf %>元</span>
      <span>服务费(每m³)&nbsp;:&nbsp;<% item.info.fwf %>元</span>
      <span>包装袋(每公斤)&nbsp;:&nbsp;<% item.info.bzdgj %>元</span>
      <span>包装袋(每m³)&nbsp;:&nbsp;<% item.info.bzdm %>元</span>
      <span>包装箱(每公斤)&nbsp;:&nbsp;<% item.info.bzxgj %>元</span>
      <span>包装箱(每m³)&nbsp;:&nbsp;<% item.info.bzxm %>元</span>
    </li>
  </ul>
  <%#  } %>
  <br>
  <%#  }); %>
  </ul>
  </script>
  <script type="text/javascript">
  var url= "__PUBLIC__/../index/info";

    layui.use(['form','laytpl'], function() {
      var form = layui.form,laytpl = layui.laytpl;
      laytpl.config({
          open: '<%',
          close: '%>'
        });
      form.on('submit(submit)', function(data) {
        $.post(url, data.field, function(res) {
          if (res.code > 0) {

            //console.log(res);
            var getTpl = demo.innerHTML
            ,view = document.getElementById('result');
            laytpl(getTpl).render(res, function(html){
              view.innerHTML="";
              view.innerHTML = html;
            });

          }else{
            //console.log(res);
            $('#result').html(res.msg);
          }
        },'json');
      });

    });
  </script>
</body>

</html>
